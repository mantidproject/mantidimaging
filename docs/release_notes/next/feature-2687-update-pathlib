#2687: Replaced all os.path usage with pathlib.Path for more robust, readable, and modern path handling.